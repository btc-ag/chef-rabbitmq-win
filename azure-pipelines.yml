# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'Ubuntu-16.04'

steps:
- task: chef-software.vsts-chef-tasks.vsts-chef-task-install-chefdk.vsts-chef-task-install-chefdk@1
  displayName: 'Install ChefDK'

- script: 'cookstyle .'
  displayName: cookstyle
  continueOnError: true

- script: 'foodcritic .'
  displayName: Foodcritic
  continueOnError: true

- task: chef-software.vsts-chef-tasks.vsts-chef-task-test-kitchen.vsts-chef-task-test-kitchen@1
  displayName: 'Execute Test Kitchen: test'
  inputs:
    tkAzureEndpoint: 'BOP-Infrastructure (5c691912-139b-48d7-ba4f-ab30c62f11a0)'
    tkKitchenFile: .kitchen.devops.yml
    tkCommand: test
